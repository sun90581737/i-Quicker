@{
    ViewBag.Title = "工程主页";
    Layout = "~/Views/Shared/_Index.cshtml";
}
@*<script src="~/Content/js/pages/app.js"></script>
<script src="~/Content/js/pages/app.min.js"></script>
<script src="~/Content/js/pages/dashboard.js"></script>*@
<script src="https://cdn.staticfile.org/echarts/4.3.0/echarts.min.js"></script>
<script src="~/Content/js/bootstrap/bootstrap.js"></script>
<link href="~/Content/js/bootstrap/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/js/pages/AdminLTE.css" rel="stylesheet" />
<link href="~/Content/js/pages/AdminLTE.min.css" rel="stylesheet" />
<style>
</style>
<script>
    window.onload = function () {
        loadOneA();
        loadTwoA();
        loadThreeA();
    }
    function loadOneA()
    {
        $.ajax({
            async: false,
            url: "/OperationMonitoring/EngineeringHomepage/GetDataUserEngineeringList",
            type: "get",
            dataType: "json",
            success: function (da) {
                var item = da[0];
                $("#a1").text(item.RealName);
                $("#b1").text(item.CustomerAmount);
                $("#b1").css({ "color": item.CustomerAmountColor });
                $("#c1").text(item.DeliveryCompletionRate + "%");
                $("#c1").css({ "color": item.DeliveryCompletionRateColor });
                $("#d1").text(item.OnTimeDeliveryMold);
                $("#d1").css({ "color": item.OnTimeDeliveryMoldColor });
                $("#e1").text(item.LateDeliveryMold);
                $("#e1").css({ "color": item.LateDeliveryMoldColor });
                $("#f1").text(item.MoldInProcess);
                $("#f1").css({ "color": item.MoldInProcessColor });
                $("#g1").text(item.NormalProgress);
                $("#g1").css({ "color": item.NormalProgressColor });
                $("#h1").text(item.ScheduleDelay);
                $("#h1").css({ "color": item.ScheduleDelayColor });
            }
        })
    }
    function loadTwoA() {
        var ListMonth = new Array();
        var ListDeliveryRate = new Array();

        $.ajax({
            async: false,
            url: "/OperationMonitoring/EngineeringHomepage/GetDataEHDeliveryCompletionRate",
            type: "get",
            dataType: "json",
            success: function (da) {
                $(da).each(function (index, item) {
                    ListMonth.push(item.Month);
                    ListDeliveryRate.push(item.DeliveryRate);
                })
            }
        })
        var myChart = echarts.init(document.getElementById('chart1'));
        var colors = ['#5793f3', '#d14a61', '#675bba'];

        var option = {
            color: colors,
            tooltip: {
                trigger: 'none',
                axisPointer: {
                    type: 'cross'
                }
            },
            grid: {
                top: 10,
                bottom: 100
            },
            xAxis: [
                {
                    type: 'category',
                    axisTick: {
                        alignWithLabel: true
                    },
                    axisLine: {
                        onZero: false,
                        lineStyle: {
                            color: colors[1]
                        }
                    },
                    axisPointer: {
                        label: {
                            formatter: function (params) {
                                return '交期达成率  ' + params.value + (params.seriesData.length ? '：' + params.seriesData[0].data : '') + '%';
                            }
                        }
                    },
                    data: ListMonth//['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12']
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    axisLabel: {
                        show: true,
                        interval: 'auto',
                        formatter: '{value} %'
                    },
                    show: true
                }
            ],
            series: [
                {
                    name: '交期达成率',
                    type: 'line',
                    smooth: true,
                    data: ListDeliveryRate,//[80, 76, 86, 96, 92, 99, 88, 90, 95, 80, 95, 88],
                    // 显示数值
                    itemStyle: {
                        normal: {
                            label: {
                                show: true,
                                formatter: '{c}%',
                                position: 'bottom',
                                color: "#505050"
                            }
                        }
                    }
                }
            ]
        };
        myChart.setOption(option);
    }
    function loadThreeA() {
        var listName = new Array();
        var str = [];

        $.ajax({
            async: false,
            url: "/OperationMonitoring/EngineeringHomepage/GetDataEHProductionSchedule",
            type: "get",
            dataType: "json",
            success: function (da) {
                $(da).each(function (index, item) {
                    listName.push(item.Name);
                    var str3 = new Object();
                    str3.name = item.Name;
                    str3.value = item.Number;
                    str[index] = str3;
                })
            }
        })

        var myChart = echarts.init(document.getElementById('chart2a'));
        var option = {
            //title: {
            //    text: '某站点用户访问来源',
            //    subtext: '纯属虚构',
            //    left: 'center'
            //},
            tooltip: {
                trigger: 'item',
                formatter: "{b} : ({c}%)"
            },
            legend: {
                orient: 'vertical',
                left: 'left',
                itemWidth: 10,  //图例标记的图形宽度
                itemHeight: 10, //图例标记的图形高度
                data: listName//['CNC', 'EDM', 'WEDM', '车铣磨抛']
            },
            color: ['#FFFF99', '#CCCC66', '#00CC99', '#FF3333'],
            series: [
                {
                    name: '访问来源',
                    type: 'pie',
                    radius: '65%',
                    center: ['50%', '50%'],
                    data: str//[{ value: 23, name: 'CNC' },{ value: 26, name: 'EDM' },{ value: 17, name: 'WEDM' },{ value: 34, name: '车铣磨抛' },]
                    ,
                    itemStyle: {  //图形样式
                        normal: { //normal 是图形在默认状态下的样式；emphasis 是图形在高亮状态下的样式，比如在鼠标悬浮或者图例联动高亮时。
                            label: {  //饼图图形上的文本标签
                                show: true,  //平常不显示
                                formatter: '{c}%',
                                position: 'inner'
                            },
                            labelLine: {     //标签的视觉引导线样式
                                show: false  //平常不显示
                            }
                        },
                        emphasis: {   //normal 是图形在默认状态下的样式；emphasis 是图形在高亮状态下的样式，比如在鼠标悬浮或者图例联动高亮时。
                            label: {  //饼图图形上的文本标签
                                show: true,
                                position: 'center',
                                textStyle: {
                                    fontSize: '20',
                                    fontWeight: 'bold'
                                }
                            },
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }
                }
            ]
        };
        myChart.setOption(option);
    }
</script>
<body>
    <div class="row">
        <div>
            <section class="col-lg-6 connectedSortable" style="width:12.5%;">
                <div class="box box-default">
                    <div class="box-header with-border">
                        <h6 id="a1" style="text-align:center;font-weight:bold;font-size:17px;color:#00CC99"></h6>
                        <h6 style="text-align:center;font-size:10px;color:#00CC99">项目工程师</h6>
                    </div>
                </div>
            </section>
            <section class="col-lg-6 connectedSortable" style="width:12.5%;">
                <div class="box box-default">
                    <div class="box-header with-border">
                        <h6 id="b1" style="text-align:center;font-weight:bold;font-size:17px;"></h6>
                        <h6 style="text-align:center;font-size:10px;color:#00CC99">负责客户数量</h6>
                    </div>
                </div>
            </section>
            <section class="col-lg-6 connectedSortable" style="width:12.5%;">
                <div class="box box-default">
                    <div class="box-header with-border">
                        <h6 id="c1" style="text-align:center;font-weight:bold;font-size:17px;"></h6>
                        <h6 style="text-align:center;font-size:10px;color:#00CC99">交期达成率(月)</h6>
                    </div>
                </div>
            </section>
            <section class="col-lg-6 connectedSortable" style="width:12.5%;">
                <div class="box box-default">
                    <div class="box-header with-border">
                        <h6 id="d1" style="text-align:center;font-weight:bold;font-size:17px;"></h6>
                        <h6 style="text-align:center;font-size:10px;color:#00CC99">按期交付模具(月)</h6>
                    </div>
                </div>
            </section>
            <section class="col-lg-6 connectedSortable" style="width:12.5%;">
                <div class="box box-default">
                    <div class="box-header with-border">
                        <h6 id="e1" style="text-align:center;font-weight:bold;font-size:17px;"></h6>
                        <h6 style="text-align:center;font-size:10px;color:#00CC99">延期交付模具(月)</h6>
                    </div>
                </div>
            </section>
            <section class="col-lg-6 connectedSortable" style="width:12.5%;">
                <div class="box box-default">
                    <div class="box-header with-border">
                        <h6 id="f1" style="text-align:center;font-weight:bold;font-size:17px;"></h6>
                        <h6 style="text-align:center;font-size:10px;color:#00CC99">在制模具</h6>
                    </div>
                </div>
            </section>
            <section class="col-lg-6 connectedSortable" style="width:12.5%;">
                <div class="box box-default">
                    <div class="box-header with-border">
                        <h6 id="g1" style="text-align:center;font-weight:bold;font-size:17px;"></h6>
                        <h6 style="text-align:center;font-size:10px;color:#00CC99">进度正常</h6>
                    </div>
                </div>
            </section>
            <section class="col-lg-6 connectedSortable" style="width:12%;">
                <div class="box box-default">
                    <div class="box-header with-border">
                        <h6 id="h1" style="text-align:center;font-weight:bold;font-size:17px;"></h6>
                        <h6 style="text-align:center;font-size:10px;color:#00CC99">进度延误</h6>
                    </div>
                </div>
            </section>
        </div>
        <div>
            <section class="col-lg-6 connectedSortable" style="width:50%">
                <div class="box box-default">
                    <div class="box-header with-border">
                        <h4 class="box-title">交期达成率</h4>
                        <div class="box-tools pull-right">
                            <button type="button" onclick="funTwo()" class="btn btn-box-tool"><i class="fa fa-expand"></i></button>
                        </div>
                    </div>
                    <div class="tab-content" style="height:100%;">
                        <div style="height:170px">
                            <div style="text-align:center;font-size:13px;">交期达成率趋势</div>
                            <div id="chart1" style="height:200px;"></div>
                        </div>
                        <div  style="height:90%;margin:20px;width:98%">
                            <div style="text-align:center;font-size:13px;">上月交付模具数量</div>
                            <div id="chart2b"></div>
                        </div>
                    </div>
                </div>
            </section>
            <section class="col-lg-6 connectedSortable" style="width:50%">
                <div class="box box-default">
                    <div class="box-header with-border">
                        <h4 class="box-title">在制进度正常、延误比例</h4>
                        <div class="box-tools pull-right">
                            <button type="button" onclick="funOne()" class="btn btn-box-tool"><i class="fa fa-expand"></i></button>
                        </div>
                    </div>
                    <div class="tab-content" style="height:100%;">
                        <div style="float:left;width:50%">
                            <div style="text-align:center;font-size:13px;">生产进度</div>
                            <div id="chart2a" style="height:325px; "></div>
                        </div>
                        <div class="gridPanel" style="margin-left:50%;width:auto;">
                            <div style="text-align:center;font-size:13px;">延期模具列表</div>
                            <table id="gridList" style="height:325px; "></table>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        <div>

        </div>
    </div>
</body>